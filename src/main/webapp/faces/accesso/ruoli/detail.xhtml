<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
	
	<ui:composition template="/WEB-INF/templates/main.xhtml">
	
		<ui:define name="container">
	
			<p:panel id="detailPanel"
					header="Ruolo" 
					style="margin-left: 10%; margin-right: 10%;">
						
				<p:tabView effect="fade" effectDuration="normal" id="tabView" dynamic="true">
				
					<p:ajax event="tabChange" listener="#{gestioneRuoli.onTabChange}" />
					
					<p:tab id="detailTab" title="Dettaglio">
					
						<h:form>
							
							<p:messages globalOnly="true" showDetail="true" closable="true"/>

							<p:focus/>
							
							<h:panelGrid columns="4" styleClass="form-panel" id="wrapper">

								<f:facet name="header">
									<h:outputText value="Il pannello permette di inserire e modificare i dati relativi al ruolo."/>
            					</f:facet>
																				
								<p:outputLabel for="nome" value="Nome:" />
								<p:inputText value="#{gestioneRuoli.edited.nome}" id="nome"
									required="true" requiredMessage="Il campo Ã¨ obbligatorio"
									style="width: 250px;"/>
								<p:watermark for="nome" value="Identificativo del ruolo" />  
								<p:message for="nome" showSummary="true" showDetail="false"/>
												
								<p:outputLabel for="descrizione" value="Descrizione:" />
								<p:inputText value="#{gestioneRuoli.edited.descrizione}" id="descrizione"
									style="width: 250px;"/>
								<p:watermark for="descrizione" value="Descrizione del ruolo" />  
								<p:message for="descrizione" showSummary="true" showDetail="false"/>

								<f:facet name="footer">
									<p:commandButton value="Salva"
										actionListener="#{gestioneRuoli.doSave}"
										update=":tabView"/>
				
									<p:button value="Chiudi" href="index.xhtml"/>
								</f:facet>
												
							</h:panelGrid>
							
						</h:form>
						
					</p:tab>
				
					<p:tab id="permessiTab" title="Permessi" disabled="#{empty gestioneRuoli.edited.id}">
					
						<h:form>
							<p:dataTable
								id="permessiTable" 
								var="permesso" 
								value="#{gestioneRuoli.permessi}"
								widgetVar="permessiTable"
								emptyMessage="Nessun record trovato"
								filteredValue="#{gestioneRuoli.filteredPermessi}"
								rowKey="#{permesso.id}"
								selection="#{gestioneRuoli.selectedPermessi}"
								paginator="true" 
								paginatorPosition="bottom" rows="10"
								paginatorTemplate="{CurrentPageReport} {RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
								currentPageReportTemplate="Trovati {totalRecords} record - Pagina {currentPage} di {totalPages}"
								rowsPerPageTemplate="5,10,50" 
								pageLinks="10">
											        		
								<f:facet name="header">
							    	Lista dei permessi
							    </f:facet>
				
								<p:column selectionMode="multiple">
								</p:column>
								
								<p:column headerText="Permesso" 
									filterBy="#{permesso.permesso}"
									filterMatchMode="contains"
									sortBy="#{permesso.permesso}">
									<h:outputText value="#{permesso.permesso}" />
								</p:column>
				
								<p:column headerText="Descrizione" 
									filterBy="#{permesso.descrizione}"
									filterMatchMode="contains"
									sortBy="#{permesso.descrizione}">
									<h:outputText value="#{permesso.descrizione}" />
								</p:column>
								
							</p:dataTable>
						</h:form>				
					</p:tab>
				
				</p:tabView>

			</p:panel>
						    
		    <p:draggable 
		    	for="detailPanel" 
		    	handle=".ui-panel-titlebar"
		    	opacity="0.3"/>
			
		</ui:define>
	
	</ui:composition>

</html>