<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<f:subview id="listTariffeView">
	
		<p:outputPanel id="buttons" style="display: block; margin-top: 2em; margin-bottom: 2em;">
	
			<p:commandButton
				id="createButton"
				value="Crea"
				actionListener="#{dettaglioContrattoTariffe.startCreate}"
				process="@this"
				update=":detailForm:tabView:detailTariffaView:detailTariffaDialog"
				oncomplete="detailTariffaDialogWidget.show();"
				icon="ui-icon-star"/>
			<p:tooltip 
				for="createButton" 
				value="Crea una nuova tariffa" 
				showEffect="fade" 
				hideEffect="fade"/>
	
			<p:commandButton
				id="deleteButton"
				value="Elimina"
				disabled="#{empty dettaglioContrattoTariffe.selected}"
				process="@this"
				update=":detailForm:tabView:deleteTariffaView:deleteTariffaDialog"
				oncomplete="deleteTariffaDialogWidget.show();"
				icon="ui-icon-trash" />
			<p:tooltip 
				for="deleteButton" 
				value="Elimina la tariffa selezionata" 
				showEffect="fade" 
				hideEffect="fade"/>
	
			<p:commandButton
				id="updateButton" 
				value="Modifica"
				disabled="#{empty dettaglioContrattoTariffe.selected}"
				actionListener="#{dettaglioContrattoTariffe.startUpdate}"
				process="@this"
				update=":detailForm:tabView:detailTariffaView:detailTariffaDialog"
				oncomplete="detailTariffaDialogWidget.show();"
				icon="ui-icon-pencil" />
			<p:tooltip 
				for="updateButton" 
				value="Modifica la tariffa selezionata" 
				showEffect="fade" 
				hideEffect="fade"/>
	
		</p:outputPanel>

		<p:dataTable 
			id="tariffeTable" 
			var="tariffa" 
			value="#{dettaglioContrattoTariffe.model}"
			paginator="true" 
			paginatorPosition="bottom" rows="10"
			paginatorTemplate="{CurrentPageReport} {RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
			currentPageReportTemplate="Trovati {totalRecords} record - Pagina {currentPage} di {totalPages}"
			rowsPerPageTemplate="5,10,50" 
			pageLinks="10"
			emptyMessage="Nessun record trovato" 
			selectionMode="single"
			selection="#{dettaglioContrattoTariffe.selected}"
			lazy="true">
	
			<p:ajax event="rowSelect" process="@this" update=":detailForm:tabView:listTariffeView:buttons"/>
			<p:ajax event="rowUnselect" process="@this" update=":detailForm:tabView:listTariffeView:buttons"/>
	      		
			<f:facet name="header">
		    	Lista delle tariffe
		    </f:facet>
	
			<p:column headerText="Descrizione" sortBy="#{tariffa.descrizione}"
				filterBy="#{tariffa.descrizione}">
				<h:outputText value="#{tariffa.descrizione}" />
			</p:column>
	
			<p:column headerText="Tipo servizio" sortBy="#{tariffa.tipoServizio.descrizione}"
				filterBy="#{tariffa.tipoServizio.descrizione}">
				<h:outputText value="#{tariffa.tipoServizio.descrizione}" />
			</p:column>
	
			<p:column headerText="Specifica servizio" sortBy="#{tariffa.specificaServizio.descrizione}"
				filterBy="#{tariffa.specificaServizio.descrizione}">
				<h:outputText value="#{tariffa.specificaServizio.descrizione}" />
			</p:column>
	
			<p:column headerText="Obiettivo servizio" sortBy="#{tariffa.obiettivoServizio.alias}"
				filterBy="#{tariffa.obiettivoServizio.alias}">
				<h:outputText value="#{tariffa.obiettivoServizio.alias}" />
			</p:column>
	
			<p:column headerText="Tipo tariffa" sortBy="#{tariffa.tipoTariffa.descrizione}"
				filterBy="#{tariffa.tipoTariffa.descrizione}">
				<h:outputText value="#{tariffa.tipoTariffa.descrizione}" />
			</p:column>
	
			<p:column headerText="Fatturazione" sortBy="#{tariffa.tipoFatturazione.descrizione}"
				filterBy="#{tariffa.tipoFatturazione.descrizione}">
				<h:outputText value="#{tariffa.tipoFatturazione.descrizione}" />
			</p:column>
	
			<p:column headerText="Costo" sortBy="#{tariffa.costo}">
				<h:outputText value="#{tariffa.costo}">
					<f:converter converterId="currencyConverter"/>
				</h:outputText>
			</p:column>
	
			<p:column headerText="Numero" sortBy="#{tariffa.numero}">
				<h:outputText value="#{tariffa.numero}"/>
			</p:column>
	
			<p:column headerText="Data inizio" sortBy="#{tariffa.dataInizioValidita}">
				<h:outputText value="#{tariffa.dataInizioValidita}">
					<f:convertDateTime pattern="dd/MM/yyyy" timeZone="#{appConfig.timeZone}" />
				</h:outputText>
			</p:column>
	
		</p:dataTable>

	</f:subview>


	<f:subview id="detailTariffaView">
		
		<p:dialog
			id="detailTariffaDialog"
			header="Dettaglio della tariffa" 
			widgetVar="detailTariffaDialogWidget" 
			modal="true"
			showEffect="fade" 
			hideEffect="fade"> 

			<p:messages id="messages" globalOnly="false" showSummary="false" showDetail="true" severity="error" closable="true"/>
	
			<p:panelGrid id="wrapper" styleClass="form-panel">

				<p:focus for="descrizione"/>
	
				<p:row>
					<p:column>				
						<p:outputLabel for="descrizione" value="Descrizione:" />
					</p:column>
					<p:column>
						<p:inputText value="#{dettaglioContrattoTariffe.descrizione}" id="descrizione"
							required="true" requiredMessage="Il campo descrizione è obbligatorio"/>
						<p:watermark for="descrizione" value="Descrizione della tariffa" />  
						<p:tooltip for="descrizione" showEffect="fade" value="Descrizione della tariffa" />
					</p:column>
				</p:row>
				
				<p:row>
					<p:column>
						<p:outputLabel for="codiceTipoServizio" value="Tipo servizio:" />
					</p:column>
					<p:column>
						<p:selectOneMenu
							required="true" 
							requiredMessage="Il campo tipo servizio è obbligatorio"
							id="codiceTipoServizio" 
							value="#{dettaglioContrattoTariffe.codiceTipoServizio}"
							effect="fade">
							<p:ajax process="@this" update="codiceSpecificaServizio" listener="#{dettaglioContrattoTariffe.populateSpecificaServizio}"/>
							<f:selectItem itemLabel="Selezionare un tipo di servizio" itemValue="" />
							<f:selectItems 
								value="#{dettaglioContrattoTariffe.listTipoServizio}" var="item"
								itemLabel="#{item.descrizione}" itemValue="#{item.id}" />
						</p:selectOneMenu>	
						<p:tooltip for="codiceTipoServizio" showEffect="fade" value="Tipo di servizio" />
					</p:column>
				</p:row>
				
				<p:row>
					<p:column>
						<p:outputLabel for="codiceSpecificaServizio" value="Specifica del servizio:" />
					</p:column>
					<p:column>
						<p:selectOneMenu
							required="true" 
							requiredMessage="Il campo specifica del servizio è obbligatorio"
							id="codiceSpecificaServizio" 
							value="#{dettaglioContrattoTariffe.codiceSpecificaServizio}"
							effect="fade">
							<f:selectItem itemLabel="Selezionare una specifica di servizio" itemValue="" />
							<f:selectItems 
								value="#{dettaglioContrattoTariffe.listSpecificaServizio}" var="item"
								itemLabel="#{item.descrizione}" itemValue="#{item.id}" />
						</p:selectOneMenu>	
						<p:tooltip for="codiceSpecificaServizio" showEffect="fade" value="Specifica di servizio" />
					</p:column>
				</p:row>
				
				<p:row>
					<p:column>
						<p:outputLabel for="codiceObiettivoServizio" value="Obiettivo di servizio:" />
					</p:column>
					<p:column>
						<p:selectOneMenu
							required="true" 
							requiredMessage="Il campo obiettivo di servizio è obbligatorio"
							id="codiceObiettivoServizio" 
							value="#{dettaglioContrattoTariffe.codiceObiettivoServizio}"
							effect="fade">
							<f:selectItem itemLabel="Selezionare un obiettivo di servizio" itemValue="" />
							<f:selectItems 
								value="#{dettaglioContrattoTariffe.listObiettivoServizio}" var="item"
								itemLabel="#{item.alias}" itemValue="#{item.id}" />
						</p:selectOneMenu>	
						<p:tooltip for="codiceObiettivoServizio" showEffect="fade" value="Obiettivo di servizio" />
					</p:column>
				</p:row>
				
				<p:row>
					<p:column>
						<p:outputLabel for="codiceTipoTariffa" value="Tipo tariffa:" />
					</p:column>
					<p:column>
						<p:selectOneMenu
							required="true" 
							requiredMessage="Il campo tipo tariffa è obbligatorio"
							id="codiceTipoTariffa" 
							value="#{dettaglioContrattoTariffe.codiceTipoTariffa}"
							effect="fade">
							<f:selectItem itemLabel="Selezionare un tipo di tariffa" itemValue="" />
							<f:selectItems 
								value="#{dettaglioContrattoTariffe.listTipoTariffa}" var="item"
								itemLabel="#{item.descrizione}" itemValue="#{item.id}" />
						</p:selectOneMenu>	
						<p:tooltip for="codiceTipoTariffa" showEffect="fade" value="Tipo di tariffa" />
					</p:column>
				</p:row>
					
				<p:row>
					<p:column>
						<p:outputLabel for="costo" value="Costo:" />
					</p:column>
					<p:column>
						<p:inputText value="#{dettaglioContrattoTariffe.costo}" id="costo"
							converter="currencyConverter" converterMessage="Il campo costo non rappresenta un importo valido"/>
						<p:watermark for="costo" value="Costo" />  
						<p:tooltip for="costo" showEffect="fade" value="Costo applicato per la tariffa" />
					</p:column>
				</p:row>
					
				<p:row>
					<p:column>
						<p:outputLabel for="numero" value="Numero:" />
					</p:column>
					<p:column>
						<p:inputText value="#{dettaglioContrattoTariffe.numero}" id="numero"
							converter="integerConverter" converterMessage="Il campo numero non rappresenta un numero intero valido"/>
						<p:watermark for="numero" value="Numero" />  
						<p:tooltip for="numero" showEffect="fade" value="Numero" />
					</p:column>
				</p:row>
				
				<p:row>
					<p:column>							
						<p:outputLabel for="dataInizioValidita" value="Data inizio validità:" />
					</p:column>
					<p:column>
						<p:calendar value="#{dettaglioContrattoTariffe.dataInizioValidita}" id="dataInizioValidita"
							pattern="dd/MM/yyyy"
							required="true" 
							requiredMessage="Il campo data inizio validità è obbligatorio"/>
						<p:watermark for="dataInizioValidita" value="Data di inizio validità" />  
						<p:tooltip for="dataInizioValidita" showEffect="fade" value="Data di inizio validità" />
					</p:column>
				</p:row>
				
				<p:row>
					<p:column>
						<p:outputLabel for="codiceTipoFatturazione" value="Tipo fatturazione:" />
					</p:column>
					<p:column>
						<p:selectOneMenu
							required="true" 
							requiredMessage="Il campo tipo fatturazione è obbligatorio"
							id="codiceTipoFatturazione" 
							value="#{dettaglioContrattoTariffe.codiceTipoFatturazione}"
							effect="fade">
							<f:selectItem itemLabel="Selezionare un tipo di fatturazione" itemValue="" />
							<f:selectItems 
								value="#{dettaglioContrattoTariffe.listTipoFatturazione}" var="item"
								itemLabel="#{item.descrizione}" itemValue="#{item.id}" />
						</p:selectOneMenu>	
						<p:tooltip for="codiceTipoFatturazione" showEffect="fade" value="Tipo di fatturazione" />
					</p:column>
				</p:row>

				<p:row>
					<p:column>							
						<p:outputLabel for="dataCessazione" value="Data cessazione:" />
					</p:column>
					<p:column>
						<p:calendar value="#{dettaglioContrattoTariffe.dataCessazione}" id="dataCessazione"
							pattern="dd/MM/yyyy"/>
						<p:watermark for="dataCessazione" value="Data di cessazione" />  
						<p:tooltip for="dataCessazione" showEffect="fade" value="Data di cessazione della tariffa" />
					</p:column>
				</p:row>
						
				<p:row>
					<p:column>							
						<p:outputLabel for="note" value="Note:" />
					</p:column>
					<p:column>
						<p:inputTextarea value="#{dettaglioContrattoTariffe.note}" id="note"/>
						<p:watermark for="note" value="Eventuali annotazioni sulla tariffa" />  
						<p:tooltip for="note" showEffect="fade" value="Eventuali annotazioni sulla tariffa" />
					</p:column>
				</p:row>
						
				<p:row>
					<p:column colspan="2" styleClass="form-footer">

						<p:commandButton value="Salva"
							actionListener="#{dettaglioContrattoTariffe.doSave}"
							process="detailTariffaDialog"
							update=":detailForm:tabView:listTariffeView:tariffeTable,:detailForm:tabView:listTariffeView:buttons,:detailForm:tabView:detailTariffaView:messages,:detailForm:tabView:detailTariffaView:wrapper,:detailForm:growl" 
							oncomplete="if(args.ok) { detailTariffaDialogWidget.hide(); }"/>
		
						<p:commandButton value="Annulla"
							type="button"
							onclick="detailTariffaDialogWidget.hide();" />

					</p:column>
				</p:row>
									
			</p:panelGrid>
					
		</p:dialog>
		
	</f:subview>
	
	
	<f:subview id="deleteTariffaView">
		
		<p:dialog
			id="deleteTariffaDialog" 
			header="Eliminazione tariffa" 
			widgetVar="deleteTariffaDialogWidget" 
			modal="true"
			showEffect="fade" 
			hideEffect="fade"> 
				
			<p:messages id="messages" globalOnly="false" showSummary="false" showDetail="true" severity="error" closable="true"/>
			
			<p:panelGrid styleClass="form-panel">
				
				<p:row>
					<p:column>		
						<h:outputText value="Si conferma l'eliminazione della tariffa selezionata?"/>
					</p:column>
				</p:row>

				<p:row>
					<p:column styleClass="form-footer">		

						<p:commandButton value="Elimina"
							actionListener="#{dettaglioContrattoTariffe.doDelete}"
							process="@this"
							update=":detailForm:tabView:listTariffeView:tariffeTable,:detailForm:tabView:listTariffeView:buttons,:detailForm:tabView:deleteTariffaView:messages,:detailForm:growl" 
							oncomplete="if(args.ok) { deleteTariffaDialogWidget.hide(); }"/>
		
						<p:commandButton value="Annulla"
							type="button"
							onclick="deleteTariffaDialogWidget.hide();" />
							
					</p:column>
				</p:row>
				
			</p:panelGrid>
			
		</p:dialog>
		
	</f:subview>
		
</html>